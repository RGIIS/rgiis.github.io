<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MPEG-DASH Live Stream</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.compiled.js"></script>
  <style>
    body {
      margin: 0;
      background: #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    video {
      width: 80%;
      max-width: 960px;
      height: auto;
      background: #111;
      border: 2px solid #444;
      border-radius: 12px;
      box-shadow: 0 0 20px #222;
    }
    #status {
      color: #0f0;
      font-family: monospace;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <video id="video" autoplay controls muted></video>
  <div id="status">Loading...</div>

  <script>
    async function initPlayer() {
      const video = document.getElementById('video');
      const status = document.getElementById('status');
      const manifestUri = 'https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/tv5_hd/default1/index.mpd';

      if (!shaka.Player.isBrowserSupported()) {
        status.textContent = 'Browser not supported!';
        return;
      }

      const player = new shaka.Player(video);

player.configure({
  drm: {
    servers: {
      'com.widevine.alpha': "https://cwip-shaka-proxy.appspot.com/no_auth",
    },
    advanced: {
      'com.widevine.alpha': {
        videoRobustness: 'SW_SECURE_DECODE',
        audioRobustness: 'SW_SECURE_CRYPTO'
      }
    }
  }
});

      // Optional: log Shaka errors for debugging
      player.addEventListener('error', event => {
        console.error('Error code', event.detail.code, event.detail);
        status.textContent = 'Shaka error ' + event.detail.code;
      });

      try {
        await player.load(manifestUri);
        status.textContent = 'Playing live stream...';
        console.log('The video has now been loaded!');
      } catch (error) {
        console.error('Error loading manifest', error);
        status.textContent = 'Failed to load stream';
      }
    }

    document.addEventListener('DOMContentLoaded', initPlayer);
  </script>
</body>
</html>
